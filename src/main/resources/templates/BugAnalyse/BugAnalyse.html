<!DOCTYPE html>
<!-- saved from url=(0052)http://getbootstrap.com/docs/4.0/examples/dashboard/ -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">

		<title>Dashboard Template for Bootstrap</title>
		<!-- Bootstrap core CSS -->
		<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
		<link rel="stylesheet" th:href="@{/layui/css/layui.css}"  media="all">

		<!-- Custom styles for this template -->
		<link th:href="@{/css/dashboard.css}" rel="stylesheet">
		<style type="text/css">
			/* Chart.js */

			@-webkit-keyframes chartjs-render-animation {
				from {
					opacity: 0.99
				}
				to {
					opacity: 1
				}
			}

			@keyframes chartjs-render-animation {
				from {
					opacity: 0.99
				}
				to {
					opacity: 1
				}
			}

			.chartjs-render-monitor {
				-webkit-animation: chartjs-render-animation 0.001s;
				animation: chartjs-render-animation 0.001s;
			}
		</style>

		<!-- 文本编辑器格式 -->
		<style type="text/css" media="screen">
    #editor {
        /*position: absolute;*/
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        height: 450px;
        width: 600px;
    }
    #editor2 {
        /*position: absolute;*/
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        height: 450px;
        width: 600px;
    }

</style>

		<!--JQuery依赖和三个Ajax请求-->
		<script src="https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
		<script>
		  function getATestcase() {
			$.post({
				url: "getATestcase",
				data: {},
				success: function(data) {
					// 获取传回的值
					let parse = JSON.parse(data);
					let suspiciousId = parse["suspiciousId"];
					let outputId = parse["outputId"];
					let testcase = parse["testcase"];
					// 值填充
					$("#SuspiciousId").text("SuspiciousId:" + suspiciousId);
					$("#HarnessId").text("HarnessId:" + outputId);
					setValue(editor, testcase);

				},
				error: function(){ alert("Ajax出错啦！")}
			});
		  }
		    function run(code) {
				$.post({
					url: "run",
					data: {code : code},
					success: function(data) {
						// data为回传的值，将其赋给ids的文本框中
						setValue(editor2, data);
					},
					error: function(){ alert("Ajax出错啦！")}
				});
			  }
		</script>

	</head>

	<body>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.11/ace.js"></script>

		<div th:replace="~{/commons/commons::topbar(page='BugAnalyse.html')}"></div>

		<div class="container-fluid">
			<div class="row">

				<div th:replace="~{/commons/commons::sidebar(page='BugAnalyse.html')}"></div>

				<main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
					<div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;">
						<div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
							<div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div>
						</div>
						<div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
							<div style="position:absolute;width:200%;height:200%;left:0; top:0"></div>
						</div>
					</div>
					<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
						<h1 id="PageTitle" class="h2">分析用例</h1>
						<div class="btn-group mr-2">
							<button class="btn btn-sm btn-outline-secondary" onclick="getATestcase()">获取用例</button>
							<button class="btn btn-sm btn-outline-secondary" onclick="run(editor.getValue())">运行</button>
							<button class="btn btn-sm btn-outline-secondary" onclick="">提交</button>
							<button class="btn btn-sm btn-outline-secondary" onclick="">恢复用例</button>
						</div>
						<div>
							<span id="SuspiciousId"></span>
							<span id="HarnessId"></span>
						</div>
						<div class="btn-toolbar mb-2 mb-md-0">
							<div>
								<span>当前共有[[${allNumber}]]条可疑用例，其中[[${analysedNumber}]]条已分析，剩余[[${noAnalysedNumber}]]条需要分析。</span>
							</div>
						</div>
					</div>

					<table>
						<tr>
							<th><div id="editor"></div></th>
							<th><div id="editor2"></div></th>
						</tr>
					</table>



				</main>
			</div>
		</div>

		<!-- Bootstrap core JavaScript
    ================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script type="text/javascript" src="../static/js/jquery-3.2.1.slim.min.js"></script>
		<script type="text/javascript" src="../static/js/popper.min.js"></script>
		<script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
		<script src="/ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
		<script>

			var editor = ace.edit("editor");
			editor.setTheme("ace/theme/monokai");
			editor.session.setMode("ace/mode/javascript");
			editor.setOption("wrap", "free");

			var editor2 = ace.edit("editor2");
			editor2.setTheme("ace/theme/monokai");
			editor2.session.setMode("ace/mode/scheme");
			editor2.setOption("wrap", "free");
			editor2.setReadOnly(true);   <!-- editor2为显示结果，改为只读 -->

			function setValue(node, data) {
				node.setValue(data);
			}
		</script>
	</body>

</html>